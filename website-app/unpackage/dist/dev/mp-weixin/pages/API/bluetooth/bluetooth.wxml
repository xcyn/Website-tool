<view><page-head vue-id="5c9bf457-1" title="{{title}}" bind:__l="__l"></page-head><view class="uni-padding-wrap uni-common-mt"><view>本蓝牙协议只支持低功耗蓝牙协议ble。如果想连接非ble蓝牙设备，请在社区搜索 Native.js 蓝牙。</view><view class="uni-btn-v"><button type="primary" disabled="{{disabled[0]}}" data-event-opts="{{[['tap',[['openBluetoothAdapter',['$event']]]]]}}" bindtap="__e">初始化蓝牙模块</button><block wx:if="{{!adapterState.available}}"><view>{{''+'蓝牙适配器不可用,请初始化蓝牙模块'+''}}</view></block><button type="primary" loading="{{searchLoad}}" disabled="{{disabled[1]}}" data-event-opts="{{[['tap',[['startBluetoothDevicesDiscovery',['$event']]]]]}}" bindtap="__e">开始搜索蓝牙设备</button><button type="primary" disabled="{{disabled[2]}}" data-event-opts="{{[['tap',[['stopBluetoothDevicesDiscovery',[false]]]]]}}" bindtap="__e">停止搜索蓝牙设备</button><button type="primary" loading="{{newDeviceLoad}}" disabled="{{disabled[3]}}" data-event-opts="{{[['tap',[['queryDevices',['$event']]]]]}}" bindtap="__e">选择设备</button><block wx:if="{{equipment.length>0}}"><view>{{''+((connected?'已连接设备':'已选择设备')+' : '+equipment[0].name+' ('+equipment[0].deviceId+')')+''}}</view></block><button type="primary" disabled="{{disabled[4]}}" data-event-opts="{{[['tap',[['createBLEConnection',['$event']]]]]}}" bindtap="__e">连接蓝牙设备</button><button type="primary" disabled="{{disabled[5]}}" data-event-opts="{{[['tap',[['getBLEDeviceServices',['$event']]]]]}}" bindtap="__e">选择设备服务</button><block wx:if="{{servicesData.length>0}}"><view>{{"已选服务uuid："+servicesData[0].uuid}}</view></block><button type="primary" disabled="{{disabled[6]}}" data-event-opts="{{[['tap',[['getBLEDeviceCharacteristics',['$event']]]]]}}" bindtap="__e">获取服务的特征值</button><block wx:if="{{characteristicsData.length>0}}"><view><view class="uni-list_name">{{"uuid:"+characteristicsData[0].uuid}}</view><view class="uni-list_item">{{'是否支持 read 操作:'+characteristicsData[0].properties.read+''}}</view><view class="uni-list_item">{{'是否支持 write 操作:'+characteristicsData[0].properties.write+''}}</view><view class="uni-list_item">{{'是否支持 notify 操作:'+characteristicsData[0].properties.notify+''}}</view><view class="uni-list_item">{{'是否支持 indicate 操作:'+characteristicsData[0].properties.indicate+''}}</view></view></block><button type="primary" disabled="{{disabled[9]}}" data-event-opts="{{[['tap',[['closeBLEConnection',['$event']]]]]}}" bindtap="__e">断开蓝牙设备</button><button type="primary" disabled="{{disabled[10]}}" data-event-opts="{{[['tap',[['closeBluetoothAdapter',['$event']]]]]}}" bindtap="__e">关闭蓝牙模块</button></view></view><block wx:if="{{maskShow}}"><view data-event-opts="{{[['touchmove',[['moveHandle',['$event']]]],['tap',[['maskclose',['$event']]]]]}}" class="uni-mask" catchtouchmove="__e" bindtap="__e"><scroll-view class="uni-scroll_box" scroll-y="{{true}}" data-event-opts="{{[['touchmove',[['moveHandle',['$event']]]],['tap',[['moveHandle',['$event']]]]]}}" catchtouchmove="__e" catchtap="__e"><view class="uni-title">{{'已经发现'+list.length+(showMaskType==='device'?'台设备':'个服务')+':'}}</view><block wx:for="{{list}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view data-event-opts="{{[['tap',[['tapQuery',['$0'],[[['list','',index]]]]]]]}}" class="uni-list-box" bindtap="__e"><block wx:if="{{showMaskType==='device'}}"><view><view class="uni-list_name">{{item.name||item.localName}}</view><view class="uni-list_item">{{"信号强度:"+item.RSSI+"dBm"}}</view><view class="uni-list_item">{{"UUID:"+item.deviceId}}</view></view></block><block wx:if="{{showMaskType==='service'}}"><view><view class="uni-list_item" style="line-height:2.2;">{{'UUID: '+item.uuid+''}}<block wx:if="{{showMaskType==='service'}}"><text>{{''+(item.isPrimary?'（主服务）':'')+''}}</text></block></view></view></block><block wx:if="{{showMaskType==='characteristics'}}"><view><view class="uni-list_name">{{"uuid:"+item.uuid}}</view><view class="uni-list_item">{{"是否支持 read 操作:"+item.properties.read}}</view><view class="uni-list_item">{{'是否支持 write 操作:'+item.properties.write+''}}</view><view class="uni-list_item">{{'是否支持 notify 操作:'+item.properties.notify+''}}</view><view class="uni-list_item">{{'是否支持 indicate 操作:'+item.properties.indicate+''}}</view></view></block></view></block></scroll-view></view></block></view>